{% extends "base.html" %}

{% block content %}
	<h3>Table #{{table.number}} orders: <div class="badge">{{table.orders.all.count}}</div></h3>
	{% for order in table.orders.all %}
	<div class="order card my-3 p-1">
		<div class="card-header">
			<div class="row">
				<div class="col-md-9">
					Order #{{order.id}}: <div class="badge">{{order.items.all.count}}</div> items		
				</div>

				<div class="btn-group col-md-3">					<form action="/orders/{{order.id}}/pay">
						<input type="submit" value="pay" class="btn btn-success" >	    
					</form>										
					<form action="/orders/{{order.id}}/cook">
						<input type="submit" value="cook" class="btn btn-warning" >	    
					</form>							
					<form action="/orders/{{order.id}}/remove">
						<input type="submit" value="&times;" class="btn btn-danger" >	    
					</form>				
				</div>				
			</div>							
		</div>
		<div class="card-body">
			<ul class="list-group">
			 	{% for item in order.items.all %}
			 	<li class="list-group-item">	        	
		            {{item.menu_item.title}} x <b>{{item.quantity}}</b> [<i>{{item.price}}</i>$]	
		        </li>
		        {% endfor %}    	 
			</ul>        	
		</div>
  		<div class="card-footer">
	  		<details>
		    	<summary>Add new item in order</summary>
		    	<form action="/orders/{{order.id}}" 
		    		method="post" class="card p-3" 
		    	>		
					{% csrf_token %}
					<div class="form-group">
						{{ item_form.as_p }}	
					</div>
					
					<input type="submit" value="save" class="form-control bg-primary text-white" >	    	
				</form>
		    </details>
  		</div>				 	           	            
	</div>
	{% endfor %}

	<form action="/orders/table/{{table.id}}" 
		method="post" class="mb-3" 
	>		
		{% csrf_token %}						      
		{{ order_form.as_p }}
		<input type="submit" class="form-control"  value="+ Add new order">	    	
	</form>
{% endblock %}

